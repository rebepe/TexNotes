\textbf{\textcolor{darkblue}{ Vorlesungsstoff}}~

	\section*{Internet Architektur und E-Commerce}
	
	\subsection*{Sicherheit nicht im Design des Internet}
		\begin{itemize}
		\item 	Fehlen der Theorie
		\item  Geschlossenes Militärnetz
		\item Schwerpunkt: Ausfallsicherheit
		\end{itemize}
	
	\subsection*{Architektur}
	\begin{itemize}
		\item 	Austausch von Forschungsergebnissen
		\item  Vernetzung von Wissen
		\item Webserver liefert statische Dokumente, die vom Browser dargestellt werden
	\end{itemize}

\subsection*{Angriffspunkte}
\begin{itemize}
	\item 	Server hacken
	\item  Nachrichten fälschen
	\item Device vom User hackenn
\end{itemize}

\subsection*{Ziele der Security für E-Commerce}
\begin{itemize}
	\item 	Daten schützen
	\item  Fehler vermeiden
	\item Fehler erkennen und beseitigen
	\item 	Daten schützen
	\item  Fehler vermeiden
	\item Auswirkung der Fehler begrenzen
\end{itemize}

\subsection*{Funktionen für E-Commerce}
\begin{itemize}
	\item 	Dynamische Inhalte
	\item  Zustand ( mehere Anfragen pro kaufvorgang, suchen, auswählen, bezahlen)
	\item Erweiterung des Web Servers (CGI)
	\item nach Appliationserver ( Java Servlets, Java Server Pages, Active Server Pages)
\end{itemize}


	\section*{Programmierfehler}
	
	\subsection*{Software Qualität}
	\begin{itemize}
		\item Definition "Sicher"?
		\item Hoher Zeitaufwand System zu brechen
		\item Erfüllt die Sicherheitsspezifikation
		\item Flaw ( Unerwartetes Verhalten), Vulnerability ( Klasse von Flaws, zb. Buffer Overflow)
	\end{itemize}

\subsection*{ Fehlerklassen}
\begin{itemize}
	\item Pufferüberlauf
	\item Unvollständige Entkopplung ( 30.2 eingeben können)
	\item Serialisierungsfehler ( time-of-check to time-of-use)
\end{itemize}

\subsection*{ Ort des Fehlers}
\subsubsection*{Standardsoftware}
\begin{itemize}
	\item Gefundene Fehler publiziert
	\item Anbieter bietet Lösung an
	\item Aber evtl. auch Exploit verfügbar
\end{itemize}
\subsubsection*{Eigene Webanwendung}
\begin{itemize}
	\item Legitime Benutzer finden selten Fehler
	\item Anzahl Hacker geringer
	\item Exploits unwahrscheinlich
\end{itemize}


\subsection*{ Pufferüberlauf}
\begin{itemize}
	\item 2L Wasser in 1L-Eimer
	\item Example in C : 	Char sample[3]; Sample[3] = 'a';
	\item Nicht entscheidbar
\end{itemize}
\subsubsection*{Folgen des Überlaufs, Überschreiben von:}
\begin{itemize}
	\item Programmdaten
	\item Betriebssytemdaten
	\item Betriebssytemcode
	\item Programmcode
	\item Rechnen mit falschen Daten
	\item Ausführen unerwünschter Instruktionen
\end{itemize}

\subsubsection*{Identifikation eines Überlaufs}
\begin{itemize}
	\item Vermutung der Existenz eines Puffers ( Konsistenzprüfung, Signaturen)
	\item Vermutung über die Länge des Puffers ( Telefonnummer, Postleitzahl)
	\item Zufall ( Absturz bei bestimmten Eingabedaten)
\end{itemize}

\subsubsection*{Überlauf und Sicherheit }
\begin{itemize}
	\item Absturz ( System oder Programm)
	\item Code mit erweiterten Rechten ( Priviligen im OS oder Server Anwendung)
\end{itemize}

\subsection*{Unvollständige Entkopplung}
\begin{itemize}
	\item Benutzereingaben nicht validiert ( 30.2, Auswahlmenüs, Format und Wertebereichsprüfung)
\end{itemize}
	=> Folgen
	\begin{itemize}
		\item Absturz ( Ausfall eines Handelsystems)
		\item Manipulation an Systemen ( SQL oder Shell Injection )
	\end{itemize}

\subsection*{ Serialisierung}
\subsubsection*{Analogon Auto Kauf}
\begin{itemize}
	\item 100 Euro Noten vor Verkäufer zählen
	\item In Umschlag stecken
	\item Verkäufer ablenken
	\item Umschlag mit 1 Euro Noten überreichen
\end{itemize}

\subsubsection*{Serialisierung in E-Commerce }
\begin{itemize}
	\item Links auf Bereiche der Anwendung:
	\item Beim Einloggen geprüft
	\item Nacher nicht mehr
	\item Versteckte Felder
	\item Links mit vorbelegten Parametern
	\item Fehlannahmen ( HTML-Seite nicht manipulierbar ( loool), Versteckte Felder unsichtbar ( firebug usw)
\end{itemize}
=> Folgen : 
\begin{itemize}
	\item Manipulation an Transaktionen ( Preis in Url)
	\item Unerwünschter Zugriff auf beschränkte Funktionen/ Daten anderer Kunden 
\end{itemize}



\section*{Einschleusen von Kommandos}
\subsection*{ SQL Injection}
\begin{itemize}
	\item Rain Forest Puppy 1998
	\item Datenbank Abfragen manipulieren ( SQL Metazeichen)
\end{itemize}
\subsubsection*{ Gegenmaßnahmen - Daten säubern }
\begin{itemize}
	\item Anführungszeichen verbieten oder Anführungszeichen verdoppeln
	\item PostgeSQL und MySQL: Backslash \
	\item Zahlen durch Parser der Programmiersprache jagen, wieder in Text umwandeln
	\item Nur Stored Procedures ( SP) erlauben, schützt nicht vor aufruf andere SPs
\end{itemize}

\subsubsection*{Gegenmaßnahmen - Prepared Statements }
\begin{itemize}
	\item  Anweisung ist bereits teilwese verarbeitet
	\item Daten haben keine Metazeichen mehr
	\item Typ-Prüfung durch Programmiersprache umwandeln
\end{itemize}


\subsection*{ Shell Injection}
\begin{itemize}
	\item Viele Metazeichen
	\item Eingabe: test; rm -rf /
\end{itemize}
\subsubsection*{ Gegenmaßnahmen - Daten säubern }
\begin{itemize}
	\item Kommandos direkt ausführen
	\item Perl(Exec, System)
	\item C/C++ (Exec  meist nach fork, nicht system oder popen)
	\item Benutzerdaten über Standardeingabe
	\item Metazeichen und Eingabevalidierung
	\item Aber Zielprogramm interpretiert Daten
	\item Shell nicht verwenden
	\item Externes Programm nicht verwenden( Wiederspricht re-use,)
	\item Codefragmente wiederverwenden aber durchsehen und HInweise lesen
\end{itemize}

\subsection*{ interaktion mit c/c++ }
\begin{itemize}
\item Zeichenkette endet mit null-Zeichen (Terminiert Zeichenkette in c)
\item Kunden laden Bilder auf Server ( Prüfe auf Endung .jpg) Eingabe : Crack.php0.jpg
\end{itemize}

\subsection*{ Evil Eval }
\begin{itemize}
	\item Werte den Inhalt einer Variable aus
	\item Eval in den meisten Skript Sprachen
	\item Java Reflection API
	\item Enthält Variable Benutzereingaben ( Kommando Injection)
\end{itemize}

\subsection*{ Metazeichenbehandlung }
\begin{itemize}
	\item Identifiziere Subsysteme
	\item Identifiziere Metazeichen der Subsysteme
	\item Typen Prüfung
	\item Injection zweiter Ordnung, O'Conner aus DB lesen, In neue SQL Abfrage eingebaut
	\item Like Klausel in SQL ( Metazeichen \%\_)
\end{itemize}

\subsection*{ Architektur }
\begin{itemize}
	\item soll beim Fehler vermeiden helfen
	\item Kommunikation Kapseln (Metazeichen an einer Stelle behandeln)
	\item Datenbanken persistents Schicht ( Hibernate, Java Beans)
\end{itemize}

\subsection*{ Gestaffelte Abwehr }
\begin{itemize}
	\item Defense in the Depth
	\item Mehrere Sicherheitsmechanismen
	\item Berechtigung im Subsystem ( DB)
	\item Eingabe Validierung ( Format E-Mail, Zahlen, Telefonnummer, Postleitzahlen, Bereichsprüfung, Längenprüfung)
	\item Unnötige Dienste in der Infrastruktur abschalten
	\item Redundanz bei Sicherheit wichtig ( Validierung in jedem System)
\end{itemize}

\subsection*{ Arten von Eingaben }
\begin{itemize}
	\item URL-Parameter
	\item Benutzer erzeugte Eingaben ( Textfelder/ Textarea)
	\item Server erzeugte Eingaben ( Auswahlfeldern, Checkboxen,  Radiobutton, Verborgene Felder)
\end{itemize}

\subsection*{ Parameter Manipulation}
\begin{itemize}
	\item Speichern, editieren und senden
	\item URL selbst erzeugen (Get vs Post)
	\item Web Proxy
	\item Browser Plugin ( Firebug)
	\item Http Header Felder ( Cookies)
	\item Dateisystem ( Weboberfläche NAS)
	\item zusätzliche Parameter
	\item Server Variablen überschreiben
	\item bei Benutzer erzeugten ungültigen Eingaben ( Tippfehler ) => höflicher Hinweis, neuer Versuch
	\item bei Server erzeugten ungültigen Eingaben ( absichtlich manipuliert) => Vorgang abbrechen, Protokollierung
\end{itemize}

\subsection*{ Filtern}
\begin{itemize}
	\item Gut
	\item Schlecht
	\item unbekannt
	\item Blacklisting ( Filtere schlechte Eingaben)
	\item Whitelisting ( Filtere gute Eingaben)
\end{itemize}



\section*{User Authentication
\subsection*{ Anforderungen}
\begin{itemize}
	\item Benutzer eindeutig identifizieren
	\item Überall verfügbar 
	\item Einfach anwendbar
\end{itemize}
\subsection*{ Passwort}
\begin{itemize}
	\item Benutzer besitzt Passwort (PIN), entweder selbst gewählt oder vom Anbieter zugeteilt
	\item Authentisierung : Benutzer gibt seine ID und Passwort ein , Server vergleicht mit Datenbank
\end{itemize}

\subsection*{Loose-Lipped System}
\begin{itemize}
	\item  Authentication mit ID und Passwort, erst ID abfragen und ungültige ID abweisen => Angreifer erhält Informationen über gültige ID
	\item daher immer (ID, Passwort) Paare prüfen => Angreifer weiß nicht ob Passwort oder ID falsch
\end{itemize}

\subsection*{ Angriffe gegen Passwort}
\begin{itemize}
	\item Probiere alle Passwörter
	\item Probiere viele wahrscheinliche Passwörter
	\item Probiere Passwörter, die für den Benutzer wahrscheinlich sind
	\item Suche die Liste der Passwörter
	\item Frage den Benutzer
	\end{itemize}

\subsection*{ Gleiche Passwörter}
\begin{itemize}
	\item Passwörter werden wiederverwendet
	\item Passwort Muster ... ( OHM-geheim. Mail-geheim ist doof => Verrät Passwort für andere ID´s / Seiten)
\end{itemize}

\subsection*{ Einmal-Passwort}
\begin{itemize}
	\item Benutzer besitzt Passwortliste
	\item Streicht verwendete PW
	\item Streichen vergessen
	\item  Frage nach Passwort oder neues PW nach Login
\end{itemize}

\subsection*{ Chipkarte}
\begin{itemize}
	\item Karte speichert (Symmetrischen Schlüssel,Privaten Schlüssel )
	\item Karte führt Verschlüsselung durch
	\item Nachteil: Verfügbarkeit in Standard Client nicht gegeben
\end{itemize}

\subsection*{ Biometrische Verfahren}
\begin{itemize}
	\item Messe ein Körpermerkmal
	\item Gelten als sehr sicher
	\item False acceptance rate, False rejection rate
	\item Sensor täuschen, umgehen
	\item Im Internet?
\end{itemize}

\subsection*{ Klassifikation}
\begin{itemize}
	\item Was man weiß: Passwort
	\item Was man hat: Passwortliste, Chipkarte
	\item Was man ist: Fingerabdruck, Ohr, Retina
\end{itemize}

\subsection*{ Kombinationen der Klassen}
\begin{itemize}
	\item Wissen und Haben ( Online Banking) => Passwort und Tan Oder Passwort und SecurID
	\item Haben und Sein => Chipkarte und Fingerabdruck
\end{itemize}

\subsection*{ Authentication in HTTP}
\begin{itemize}
	\item Basic Authentication ( Passwort im Klartext, Ok wenn über TLS)
	\item Digest Authentication ( Passwort plus Challenge mit Hash)a
\end{itemize}




\section*{Viren, Würmer und Trojanische Pferde}
	\subsection*{ Virus (Definition)}
	\begin{itemize}
		\item Programm (-Stück)
		\item "Infiziert" Programm
		\item Verbreitung über infizierte Programme
		\item Makroviren betreffen auch "Daten" 
		\item Meist Schadensfunktion ( Dateien löschen, Platten formatieren/verschlüsseln, Konfiguration manipulieren)
	\end{itemize}
	\subsubsection*{ Infektionsmechanismen}
	\begin{itemize}
		\item Wirtsprogramm ( Virus hängt/umfasst oder integriert sich an/in das Programm)
		\item Andere Infektionsorte ( Boot-Sector, Speicher ( RAM), Programm Bibliotheken)
	\end{itemize}
	
	\subsubsection*{Brain Virus}
	\begin{itemize}
		\item  Sitzt im Boot-Sektor und weiteren
		\item Versteckt sich im "Upper Memory"
		\item Fängt Disk-Leseoperation ab
		\item "Schaden": Ändert Disk-Label auf "Brain"
	\end{itemize}
	
	\subsubsection*{ Viren Scanner}
	\begin{itemize}
		\item Allgemeines Virenproblem unentscheidbar
		\item Erkennen anhand von Mustern
		\item Wirkt nur gegen bekannte Viren
		\item Ständige Aktualisierung ( mehrmals täglich, automatisiert)
	\end{itemize}
	
	\subsection*{ Würmer (Definition)}
	\begin{itemize}
		\item Verbreitung über Netze (Internet)
		\item Ziel: alle Rechner im Netz infizieren
		\item Meist Schadensfunktion
	\end{itemize}

\subsubsection*{ Wurm Schadensfunktion}
\begin{itemize}
	\item Wie bei Viren
	\item Zombies für DDOS
	\item ugang zu Rechnern öffnen und offen halten
	\item Nutzt Schwachstellen in Diensten ( Programmierfehler, Fehlkonfiguration)
\end{itemize}

\subsubsection*{ Code Red und Varianten}
\begin{itemize}
	\item Programmierfehler in Microsoft IIS ( Beliebiger Code ausführbar)
	\item Rasche Verbreitung via HTTP
	\item Schäden( Startseite ersetzt(Defacement), Hohe Netzlast, DDOS gegen whitehouse, Nimda ( Hintertür mit Admin-Rechte)
\end{itemize}

\subsubsection*{ Schutz }
\begin{itemize}
	\item Schwachstelle beseitigt (Patch) ( schwierig auf Produktivsystemen)
	\item Konfiguration regelmäßig prüfen
	\item Nur Notwendige Dienste aktiv
	\item Firewall als Unterstützung
\end{itemize}


	\subsection*{Trojanisches Pferd (Defenition)}
\begin{itemize}
	\item Programm mit zweiter Funktion ( versteckt)
	\item Benutzer verwendet Programm freiwillig
	\item Schäden ( gefälschter Login Dialog, Keylogger)
\end{itemize}

\subsubsection*{ Weitere Formen }
\begin{itemize}
	\item Logische Bombe( wird bei bestimmter Bedingung aktiviert)
	\item Zeitbombe
	\item Hintertür 
	\item Fork Bombe
\end{itemize}

\subsubsection*{ Im Web }
\begin{itemize}
	\item Phising ( gefälschte Seite, vorbereitete Transaktion im Link, Formular automatisch Absenden)
	\item Cross-Site-Request Forgery ( XSRF), Sitzung in anderem Fenster, Kommandos an andere Programme
\end{itemize}

\subsubsection*{ Lösung }
\begin{itemize}
	\item Ticket für Aktionen( Zufallszahlen, Unterscheidung durch ID, Hidden Fields)
\end{itemize}

\subsubsection*{ Grenzen }
\begin{itemize}
	\item GET, Cross-Side-Scripting
\end{itemize}

\subsubsection*{ Weitere Fortschritte }
\begin{itemize}
	\item Web Service
	\item AJAX
	\item Web Sockets
\end{itemize}


\section*{Public Key Infrastructure (PKI)}
\subsection*{ Ziel}
Ziel 			=> sichere Verteilung der Public Keys
Zertifikat	 =>Identifiziere für eine Person, Schlüssel und Unterschrift von einem der das beglaubigt!

\subsection*{Allgemeines zu PKI}
\begin{itemize}
\item Es gibt unterscheidliche Vertrauensmodelle, alle haben Ihre Stärken und Schwächen
\item Grundsatzfrage : wer vertraut wem und wie vertrauenswürdig ist derjenige dem ich vertraue?
\item Zertifikate sind Bestätigungen wer wer ist
\item Verfallsdatum von Zertifikaten sinnvoll
\item Ziel ist es, eine stabile, kaum angreifbare Vertrauenskette zu erschaffen!
\end{itemize}

\section*{Firewalls}

\subsection*{ Definition }
\begin{itemize}
	\item Internes, geschütztes Netz
	\item Externes, weniger vertrauenswürdiges Netz
	\item Firewall(FW) filtert Kommunikation zwischen internem und externen Netz
	\item Ziele : Schutz internen Netzes vor externen Angriffen und Kontrolle Kommunikation zu externem Netz
\end{itemize}

\subsection*{ Kernidee }
\begin{itemize}
	\item Referenzmonitor
	\item Immer aufgerufen ( einzige Verbindung zu externe via FWs)
	\item Manipulationssicher
	\item Klein und einfach genug für Verifikation
\end{itemize}

\subsection*{ Arten }
\begin{itemize}
	\item Paketfilter
	\item Stateful inspection FWs
	\item Applikation Proxies
	\item Guards
	\item Personal FW
\end{itemize}

\subsubsection*{ Paketfilter }
\begin{itemize}
	\item Filtert Quell und Zieladresse ( auch auf Port)
	\item Filtert manipuliert interne Adresse
	\item Einfache Regeln
	\item Aufwand für komplexe Policies ( Viele Regeln, SSH für Admins)
\end{itemize}

\subsubsection*{ Stateful inspection }
\begin{itemize}
	\item Betrachte Vorgeschichte zu Paket
	\item Merke Zustand ( State, context)
	\item Erkennt fragmentierte Angriffe ( TCP Paketreihenfolge)
\end{itemize}

\subsubsection*{ Applikation Proxies }
\begin{itemize}
	\item Bastion Host
	\item Simuliert Anwendung
	\item Filtert auch auf Paketinhalt ( zb nur Http POST / GET)
	\item Schutz für Standard Anwendungen
	\item für Web Anwendungen begrenzt geeignet
\end{itemize}

\subsubsection*{ Guards }
\begin{itemize}
	\item Application Proxy
	\item Und Anfragen ändern
	\item Regeln beliebig flexibel
	\item Virenscan auf eingehenden Dateien
	\item Web Application Firewall
\end{itemize}

\subsubsection*{ Applications-Firewall }
\begin{itemize}
	\item Selbstlernend (Parsing HTML-Seiten, Identifkation möglicher Antworten, Filter unmöglicher Antworten)
	\item Implementation: Reverse Proxy 
	\item Grenzen: Valierung der Benutzereingabe, Performance
\end{itemize}

\subsubsection*{ Personal Firewalls }
\begin{itemize}
	\item Schutz einzelner Rechner
	\item Programm auf dem PC
	\item Definition der Policy ( Anwender?)
	\item Angreifer umgeht PFW
	\item U-turn Attack bei mobilen Benutzer
\end{itemize}

\subsection*{ Möglichkeiten und Grenzen }
\begin{itemize}
	\item FW als einziger Netzübergang 
	\item Kein Schutz nach Verlassen der FW
	\item FW als Ziel der Angreifer
	\item FW Konfiguration periodisch prüfen
	\item Geringe Kontrolle über Inhalte
	\item Firewalls alleine machen eine Infrastruktur nicht sicher!
\end{itemize}


\subsection*{  Fortschritte }
\begin{itemize}
	\item VPN, IDS etc. auf der FW
	\item Firewall-Tunneling ( HTTP, SSH,…) , SOAP, Websocktes
	\item Webservices
	\item Moderne Firewalls != Refernezmonitor
	\item Komplex nicht einfach
	\item Getunnelt nicht immer aufgerufen
	\item Internetsteuerbar nicht Manipulationssicher
\end{itemize}
